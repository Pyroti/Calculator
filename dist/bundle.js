(()=>{"use strict";const e=function(e,n,t){this.execute=e,this.undo=n,this.value=t},n=(e,n)=>e+n,t=(e,n)=>e-n,u=(e,n)=>e*n,o=(e,n)=>e/n,r=e=>e/100,c=e=>100*e,l=e=>e**2,a=e=>e**.5,i=e=>e**3,w=e=>e**(1/3),s=(e,n)=>e**n,d=(e,n)=>e**(1/n),f=e=>Math.E**e,v=e=>Math.log(e)/Math.log(Math.E),x=e=>Math.log10(e),m=e=>10**e,g=e=>1/e,h=e=>Math.log(e),p=function(u){return new e(n,t,u)},E=function(u){return new e(t,n,u)},q=function(n){return new e(u,o,n)},y=function(n){return new e(o,u,n)},M=function(n){return new e(r,c,n)},S=function(n){return new e(l,a,n)},$=function(n){return new e(a,l,n)},_=function(n){return new e(i,w,n)},b=function(n){return new e(w,i,n)},A=function(n){return new e(s,d,n)},C=function(n){return new e(d,s,n)},L=function(n){return new e(f,v,n)},N=function(n){return new e(x,m,n)},V=function(n){return new e(m,x,n)},O=function(n){return new e(g,g,n)},F=function(n){return new e(h,f,n)},I=[],j=function(){let e=0,n=0;return{execute(t){console.log(`добавлен ${++n} в стек ${e} :  ${t.value}`),e=t.execute(e,t.value),I.push(t),console.log(I)},undo(){if(I.length>0){const t=I.pop();console.log(`удален  ${--n} из стек текущий ${e} : команд вэлю ${t.value}`),e=t.undo(e,t.value)}},setValue(n,t){e=n,"AC"===t&&(I.length=0)},getCurrentValue:()=>e}},k=document.querySelector(".calc__result"),z=document.querySelectorAll(".operation"),B=document.querySelectorAll(".num"),D=document.querySelector(".calc__result"),G=document.querySelector(".calc__butt-equels"),H=document.querySelector(".clear"),J=document.querySelector(".undo");let K="",P="",Q="";function R(){P=function(e,n,t){const u=new Map([["+",new p(+n)],["-",new E(+n)],["*",new q(+n)],["/",new y(+n)],["%",new M(+n)],["x2",new S(+n)],["2x",new $(+n)],["x3",new _(+n)],["3x",new b(+n)],["^",new A(+n)],["^(1/",new C(+n)],["exp",new L(+n)],["log",new N(+n)],["10x",new V(+n)],["1/x",new O(+n)],["ln",new F(+n)]]),o=new j;o.setValue(+e,t),u.has(t)?o.execute(u.get(t)):"AC"===t?o.setValue(0,t):"undo"===t&&o.undo();const r=Number(o.getCurrentValue().toFixed(15));return k.value=r,r}(P,Q,K),Q="",D.value=P}function T(e){const n=e.target.dataset.value,t="number"==typeof Number(n),u=Number.isNaN(parseInt(n,10));!function(e){P+="","."===e&&""===K?-1===P.indexOf(".")&&(P+=".",D.value+="."):"."===e&&""!==K&&-1===Q.indexOf(".")&&(Q+=".",D.value+=".")}(n),t&&!u&&""===K?("0"===D.value&&(D.value=""),P+=n,D.value+=n):t&&!u&&""!==K&&(Q+=n,D.value+=n)}function U(e){const n=e.target.dataset.value;""!==K&&""!==Q&&R(),K=n,D.value+=n,["%","2x","x2","3x","x3","exp","log","10x","1/x","ln"].includes(K)&&R()}z.forEach((e=>{e.addEventListener("mousedown",U)})),B.forEach((e=>{e.addEventListener("mousedown",T)})),G.addEventListener("mousedown",(function(){""!==Q&&R(),K=""})),H.addEventListener("mousedown",(function(){K="AC",R(),K=""})),J.addEventListener("mousedown",(function(){K="undo",R(),K=""}))})();