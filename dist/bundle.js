(()=>{"use strict";const e=function(e,n,t){this.execute=e,this.undo=n,this.value=t},n=(e,n)=>e+n,t=(e,n)=>e-n,u=(e,n)=>e*n,o=(e,n)=>e/n,r=e=>e/100,c=e=>100*e,l=e=>e**2,a=e=>e**.5,i=e=>e**3,s=e=>e**(1/3),d=(e,n)=>e**n,f=(e,n)=>e**(1/n),w=e=>Math.E**e,v=e=>Math.log(e)/Math.log(Math.E),m=e=>Math.log10(e),x=e=>10**e,g=e=>1/e,h=e=>Math.log(e),p=function(u){return new e(n,t,u)},E=function(u){return new e(t,n,u)},y=function(n){return new e(u,o,n)},q=function(n){return new e(o,u,n)},S=function(n){return new e(r,c,n)},M=function(n){return new e(l,a,n)},$=function(n){return new e(a,l,n)},A=function(n){return new e(i,s,n)},L=function(n){return new e(s,i,n)},_=function(n){return new e(d,f,n)},b=function(n){return new e(f,d,n)},C=function(n){return new e(w,v,n)},N=function(n){return new e(m,x,n)},V=function(n){return new e(x,m,n)},O=function(n){return new e(g,g,n)},F=function(n){return new e(h,w,n)},I=[];let j=0;const k=function(){let e=0;return{execute(n){console.log(`добавлен ${++j} в стек ${e} :  ${n.value}`),e=n.execute(e,n.value),I.push(n),console.log(I)},undo(){if(I.length>0){const n=I.pop();console.log(`удален ${j--} из стек текущий ${e} : команд вэлю ${n.value}`),e=n.undo(e,n.value)}},setValue(n,t){e=n,"AC"===t&&(I.length=0)},getCurrentValue:()=>e}},z=document.querySelector(".calc__result");let B=0;const D=document.querySelectorAll(".operation"),G=document.querySelectorAll(".num"),H=document.querySelector(".calc__result"),J=document.querySelector(".calc__butt-equels"),K=document.querySelector(".clear"),P=document.querySelector(".undo"),Q=document.querySelectorAll(".memory-operation");let R="",T="",U="";function W(){T=function(e,n,t){const u=new Map([["+",new p(+n)],["-",new E(+n)],["*",new y(+n)],["/",new q(+n)],["%",new S(+n)],["x2",new M(+n)],["2x",new $(+n)],["x3",new A(+n)],["3x",new L(+n)],["^",new _(+n)],["^(1/",new b(+n)],["exp",new C(+n)],["log",new N(+n)],["10x",new V(+n)],["1/x",new O(+n)],["ln",new F(+n)]]),o=new k;o.setValue(+e,t),u.has(t)?o.execute(u.get(t)):"AC"===t?o.setValue(0,t):"undo"===t&&o.undo();const r=Number(o.getCurrentValue().toFixed(15));return z.value=r,`${r}`}(T,U,R),U="",H.value=T}function X(e){const n=e.target.dataset.value,t="number"==typeof Number(n),u=Number.isNaN(parseInt(n,10));!function(e){const n="."===e,t=""===R,u=-1===T.indexOf("."),o=-1===U.indexOf(".");if(n&&t&&u)T+=".",H.value+=".";else if(n&&!t&&o){const e=""===U?"0.":".";U=e,H.value+=e}}(n),t&&!u&&""===R?("0"===H.value&&(H.value=""),T+=n,H.value+=n):t&&!u&&""!==R&&(U+=n,H.value+=n)}function Y(e){const n=e.target.dataset.value;""!==R&&""!==U&&W(),""!==R&&""===U&&(H.value=H.value.replace(R,"")),R=n,H.value+=n,["%","2x","x2","3x","x3","exp","log","10x","1/x","ln"].includes(R)&&W()}function Z(e){""!==U&&W();const[n,t]=function(e,n){const t=e.target.dataset.value;if("m+"===t)B+=+n;else if("m-"===t)B-=+n;else{if("mc"!==t)return[B,!0];B=0}return[B,!1]}(e,T);!0===t&&(H.value=n,T=n)}D.forEach((e=>{e.addEventListener("mousedown",Y)})),G.forEach((e=>{e.addEventListener("mousedown",X)})),Q.forEach((e=>{e.addEventListener("mousedown",Z)})),J.addEventListener("mousedown",(function(){""!==U&&W(),R=""})),K.addEventListener("mousedown",(function(){R="AC",W(),R=""})),P.addEventListener("mousedown",(function(){R="undo",W(),R=""}))})();