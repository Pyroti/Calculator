(()=>{"use strict";const e=function(e,n,t){this.execute=e,this.undo=n,this.value=t},n=(e,n)=>e+n,t=(e,n)=>e-n,u=(e,n)=>e*n,o=(e,n)=>e/n,r=e=>e/100,c=e=>100*e,l=e=>e**2,a=e=>e**.5,i=e=>e**3,s=e=>e**(1/3),d=(e,n)=>e**n,f=(e,n)=>e**(1/n),w=e=>Math.E**e,v=e=>Math.log(e)/Math.log(Math.E),m=e=>Math.log10(e),x=e=>10**e,g=e=>1/e,h=e=>Math.log(e),p=function(u){return new e(n,t,u)},$=function(u){return new e(t,n,u)},E=function(n){return new e(u,o,n)},y=function(n){return new e(o,u,n)},q=function(n){return new e(r,c,n)},S=function(n){return new e(l,a,n)},b=function(n){return new e(a,l,n)},N=function(n){return new e(i,s,n)},L=function(n){return new e(s,i,n)},M=function(n){return new e(d,f,n)},A=function(n){return new e(f,d,n)},_=function(n){return new e(w,v,n)},C=function(n){return new e(m,x,n)},V=function(n){return new e(x,m,n)},O=function(n){return new e(g,g,n)},F=function(n){return new e(h,w,n)},I=[],j=[];let k=0;const z=function(){let e=0;return{execute(n){console.log(`добавлен ${++k} в стек ${e} :  ${n.value}`),e=n.execute(e,n.value),I.push(n),j.push(e),console.log(I)},undo(){if(I.length>0){const n=I.pop(),t=j.pop();console.log(`удален ${k--} из стек текущий ${t} : команд вэлю ${n.value}`),e=n.undo(t,n.value)}},setValue(n,t){e=n,"AC"===t&&(I.length=0,j.length=0)},getCurrentValue:()=>e}},B=document.querySelector(".calc__result");let D=0;const G=document.querySelectorAll(".operation"),H=document.querySelectorAll(".num"),J=document.querySelector(".calc__result"),K=document.querySelector(".calc__butt-equels"),P=document.querySelector(".clear"),Q=document.querySelector(".undo"),R=document.querySelectorAll(".memory-operation"),T=document.querySelector(".negative-operation"),U=["%","2x","x2","3x","x3","exp","log","10x","1/x","ln"];let W="",X="",Y="";function Z(){X=function(e,n,t){const u=new Map([["+",new p(+n)],["-",new $(+n)],["*",new E(+n)],["/",new y(+n)],["%",new q(+n)],["x2",new S(+n)],["2x",new b(+n)],["x3",new N(+n)],["3x",new L(+n)],["^",new M(+n)],["^(1/",new A(+n)],["exp",new _(+n)],["log",new C(+n)],["10x",new V(+n)],["1/x",new O(+n)],["ln",new F(+n)]]),o=new z;"undo"!==t&&o.setValue(+e,t),u.has(t)?o.execute(u.get(t)):"AC"===t?o.setValue(0,t):"undo"===t&&o.undo();const r=Number(o.getCurrentValue().toFixed(15));return B.value=r,`${r}`}(X,Y,W),Y="",J.value=X}function ee(e){const n=e.target.dataset.value,t="number"==typeof Number(n),u=Number.isNaN(parseInt(n,10));!function(e){const n="."===e,t=""===W,u=-1===X.indexOf("."),o=-1===Y.indexOf(".");if(n&&t&&u)X+=".",J.value+=".";else if(n&&!t&&o){const e=""===Y?"0.":".";Y+=e,J.value+=e}}(n),t&&!u&&""===W?("0"===J.value&&(J.value=""),X+=n,J.value+=n):t&&!u&&""!==W&&(Y+=n,J.value+=n)}function ne(e){const n=e.target.dataset.value;""!==W&&""!==Y&&Z(),""!==W&&""===Y&&(J.value=J.value.replace(W,"")),W=n,J.value+=n,U.includes(W)&&Z()}function te(e){""!==Y&&Z();const[n,t]=function(e,n){const t=e.target.dataset.value;if("m+"===t)D+=+n;else if("m-"===t)D-=+n;else{if("mc"!==t)return[D,!0];D=0}return[D,!1]}(e,X);!0===t&&(J.value=n,X=`${n}`)}G.forEach((e=>{e.addEventListener("mousedown",ne)})),H.forEach((e=>{e.addEventListener("mousedown",ee)})),R.forEach((e=>{e.addEventListener("mousedown",te)})),T.addEventListener("mousedown",(function(){const e=""===W,n=U.includes(W),t=""===Y;e||n?(X=""+-1*Number(X),J.value=X):e||n||t||(Y=""+-1*Number(Y),Number(Y)<=0?J.value=`${X}${W}(${Y})`:J.value=`${X}${W}${Y}`)})),K.addEventListener("mousedown",(function(){""!==Y&&(Z(),W="")})),P.addEventListener("mousedown",(function(){W="AC",Z(),W=""})),Q.addEventListener("mousedown",(function(){W="undo",Z(),W=""}))})();